{"version":3,"names":["tryRequireBy","packageName","mainModule","throwWhenNotFound","require2","createRequire","text","ensureEndsWith","path","sep","require","error","code","pkgPaths","split","npmPkgName","startsWith","length","pos1","message","indexOf","realModuleName","substr","pos2","Error","undefined","tryRequire","basePath","process","cwd","main"],"sources":["tryRequire.js"],"sourcesContent":["import { createRequire } from 'module';\nimport { text } from '@genx/july';\nimport path from 'path';\n\nfunction tryRequireBy(packageName, mainModule, throwWhenNotFound) {\n    try {\n        if (typeof mainModule === 'string') {\n            const require2 = createRequire(\n                text.ensureEndsWith(mainModule, path.sep)\n            );\n            return require2(packageName);\n        }\n\n        return mainModule.require(packageName);\n    } catch (error) {\n        if (error.code === 'MODULE_NOT_FOUND') {\n            if (throwWhenNotFound) {\n                let pkgPaths = packageName.split('/');\n                let npmPkgName = pkgPaths[0];\n\n                if (npmPkgName.startsWith('.')) {\n                    //path\n                    throw error;\n                }\n\n                if (npmPkgName.startsWith('@') && pkgPaths.length > 1) {\n                    npmPkgName += '/' + pkgPaths[1];\n                }\n\n                let pos1 = error.message.indexOf(\"'\");\n                let realModuleName = error.message.substr(pos1 + 1);\n                let pos2 = realModuleName.indexOf(\"'\");\n                realModuleName = realModuleName.substr(0, pos2);\n\n                if (realModuleName === packageName) {\n                    throw new Error(\n                        `Module \"${packageName}\" not found. Try run \"npm install ${npmPkgName}\" to install the dependency.`\n                    );\n                }\n\n                throw error;\n            }\n\n            return undefined;\n        }\n\n        throw error;\n    }\n}\n\n/**\n * Try require a package module and show install tips if not found.\n * @alias helpers.tryRequire\n * @param {string} packageName\n * @returns {object}\n */\nfunction tryRequire(packageName, basePath) {\n    // eslint-disable-next-line no-undef\n    basePath != null || (basePath = process.cwd());\n\n    // hack for bun sh\n    return require.main\n        ? tryRequireBy(packageName, require.main, basePath == null) ||\n              tryRequireBy(packageName, basePath, true)\n        : require(packageName);\n}\n\nexport default tryRequire;\n"],"mappings":";;;;;;AAAA;AACA;AACA;AAAwB;AAExB,SAASA,YAAY,CAACC,WAAW,EAAEC,UAAU,EAAEC,iBAAiB,EAAE;EAC9D,IAAI;IACA,IAAI,OAAOD,UAAU,KAAK,QAAQ,EAAE;MAChC,MAAME,QAAQ,GAAG,IAAAC,qBAAa,EAC1BC,UAAI,CAACC,cAAc,CAACL,UAAU,EAAEM,aAAI,CAACC,GAAG,CAAC,CAC5C;MACD,OAAOL,QAAQ,CAACH,WAAW,CAAC;IAChC;IAEA,OAAOC,UAAU,CAACQ,OAAO,CAACT,WAAW,CAAC;EAC1C,CAAC,CAAC,OAAOU,KAAK,EAAE;IACZ,IAAIA,KAAK,CAACC,IAAI,KAAK,kBAAkB,EAAE;MACnC,IAAIT,iBAAiB,EAAE;QACnB,IAAIU,QAAQ,GAAGZ,WAAW,CAACa,KAAK,CAAC,GAAG,CAAC;QACrC,IAAIC,UAAU,GAAGF,QAAQ,CAAC,CAAC,CAAC;QAE5B,IAAIE,UAAU,CAACC,UAAU,CAAC,GAAG,CAAC,EAAE;UAC5B;UACA,MAAML,KAAK;QACf;QAEA,IAAII,UAAU,CAACC,UAAU,CAAC,GAAG,CAAC,IAAIH,QAAQ,CAACI,MAAM,GAAG,CAAC,EAAE;UACnDF,UAAU,IAAI,GAAG,GAAGF,QAAQ,CAAC,CAAC,CAAC;QACnC;QAEA,IAAIK,IAAI,GAAGP,KAAK,CAACQ,OAAO,CAACC,OAAO,CAAC,GAAG,CAAC;QACrC,IAAIC,cAAc,GAAGV,KAAK,CAACQ,OAAO,CAACG,MAAM,CAACJ,IAAI,GAAG,CAAC,CAAC;QACnD,IAAIK,IAAI,GAAGF,cAAc,CAACD,OAAO,CAAC,GAAG,CAAC;QACtCC,cAAc,GAAGA,cAAc,CAACC,MAAM,CAAC,CAAC,EAAEC,IAAI,CAAC;QAE/C,IAAIF,cAAc,KAAKpB,WAAW,EAAE;UAChC,MAAM,IAAIuB,KAAK,CACV,WAAUvB,WAAY,qCAAoCc,UAAW,8BAA6B,CACtG;QACL;QAEA,MAAMJ,KAAK;MACf;MAEA,OAAOc,SAAS;IACpB;IAEA,MAAMd,KAAK;EACf;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAASe,UAAU,CAACzB,WAAW,EAAE0B,QAAQ,EAAE;EACvC;EACAA,QAAQ,IAAI,IAAI,KAAKA,QAAQ,GAAGC,OAAO,CAACC,GAAG,EAAE,CAAC;;EAE9C;EACA,OAAOnB,OAAO,CAACoB,IAAI,GACb9B,YAAY,CAACC,WAAW,EAAES,OAAO,CAACoB,IAAI,EAAEH,QAAQ,IAAI,IAAI,CAAC,IACrD3B,YAAY,CAACC,WAAW,EAAE0B,QAAQ,EAAE,IAAI,CAAC,GAC7CjB,OAAO,CAACT,WAAW,CAAC;AAC9B;AAAC,eAEcyB,UAAU;AAAA"}