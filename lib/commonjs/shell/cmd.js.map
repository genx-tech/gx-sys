{"version":3,"sources":["cmd.js"],"names":["run_","cmd","options","Promise","resolve","reject","childProcess","exec","windowsHide","error","stdout","stderr","result","runLive_","args","onStdOut","onStdErr","ps","spawn","e","on","code","runSync","execSync","toString"],"mappings":";;;;;;;AAAA;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMA,IAAI,GAAG,CAACC,GAAD,EAAMC,OAAN,KAChB,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KACRC,uBAAaC,IAAb,CACIN,GADJ,EAEI;AAAEO,EAAAA,WAAW,EAAE,IAAf;AAAqB,KAAGN;AAAxB,CAFJ,EAGI,CAACO,KAAD,EAAQC,MAAR,EAAgBC,MAAhB,KAA2B;AACvB,MAAIF,KAAJ,EAAW;AACP,WAAOJ,MAAM,CAACI,KAAD,CAAb;AACH;;AAED,MAAIG,MAAM,GAAG;AAAEF,IAAAA,MAAF;AAAUC,IAAAA;AAAV,GAAb;AAEA,SAAOP,OAAO,CAACQ,MAAD,CAAd;AACH,CAXL,CADJ,CADG;AAiBP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AACO,MAAMC,QAAQ,GAAG,CAACZ,GAAD,EAAMa,IAAN,EAAYC,QAAZ,EAAsBC,QAAtB,EAAgCd,OAAhC,KACpB,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAC7B,MAAIY,EAAE,GAAGX,uBAAaY,KAAb,CAAmBjB,GAAnB,EAAwBa,IAAxB,EAA8B;AACnCN,IAAAA,WAAW,EAAE,IADsB;AAEnC,OAAGN;AAFgC,GAA9B,CAAT;;AAIA,MAAIiB,CAAJ;;AAEA,MAAIJ,QAAJ,EAAc;AACVE,IAAAA,EAAE,CAACP,MAAH,CAAUU,EAAV,CAAa,MAAb,EAAqBL,QAArB;AACAC,IAAAA,QAAQ,KAARA,QAAQ,GAAKD,QAAL,CAAR;AACH;;AAED,MAAIC,QAAJ,EAAc;AACVC,IAAAA,EAAE,CAACN,MAAH,CAAUS,EAAV,CAAa,MAAb,EAAqBJ,QAArB;AACH;;AAEDC,EAAAA,EAAE,CAACG,EAAH,CAAM,OAAN,EAAgBC,IAAD,IAAWF,CAAC,GAAGd,MAAM,CAACc,CAAD,CAAT,GAAef,OAAO,CAACiB,IAAD,CAAjD;AACAJ,EAAAA,EAAE,CAACG,EAAH,CAAM,OAAN,EAAgBX,KAAD,IAAW;AACtBU,IAAAA,CAAC,GAAGV,KAAJ;AACH,GAFD;AAGH,CApBD,CADG;AAuBP;AACA;AACA;AACA;AACA;AACA;;;;;AACO,MAAMa,OAAO,GAAG,CAACrB,GAAD,EAAMC,OAAN,KACnBI,uBAAaiB,QAAb,CAAsBtB,GAAtB,EAA2B;AAAEO,EAAAA,WAAW,EAAE,IAAf;AAAqB,KAAGN;AAAxB,CAA3B,EAA8DsB,QAA9D,EADG","sourcesContent":["import childProcess from 'child_process';\n\n/**\n * Execute a shell command.\n * @function module:cmd.run_\n * @param {string} cmd - Command line to execute\n * @param {object} options\n * @returns {Promise.<Object>}\n */\nexport const run_ = (cmd, options) =>\n    new Promise((resolve, reject) =>\n        childProcess.exec(\n            cmd,\n            { windowsHide: true, ...options },\n            (error, stdout, stderr) => {\n                if (error) {\n                    return reject(error);\n                }\n\n                let result = { stdout, stderr };\n\n                return resolve(result);\n            }\n        )\n    );\n\n/**\n * Execute a shell command and lively output\n * @function module:cmd.runLive_\n * @param {string} cmd - Command line to execute\n * @param {Array} [args] - Arguments list * \n * @param {*} onStdOut - \n * @param {*} onStdErr \n * @param {*} options \n * @returns {Promise.<Object>}\n */\nexport const runLive_ = (cmd, args, onStdOut, onStdErr, options) =>\n    new Promise((resolve, reject) => {\n        let ps = childProcess.spawn(cmd, args, {\n            windowsHide: true,\n            ...options,\n        });\n        let e;\n\n        if (onStdOut) {\n            ps.stdout.on('data', onStdOut);\n            onStdErr ??= onStdOut;\n        }\n\n        if (onStdErr) {\n            ps.stderr.on('data', onStdErr);\n        } \n\n        ps.on('close', (code) => (e ? reject(e) : resolve(code)));\n        ps.on('error', (error) => {\n            e = error;\n        });\n    });\n\n/**\n * Execute a shell command synchronously\n * @function module:cmd.runSync\n * @param {string} cmd - Command line to execute\n * @returns {string}\n */\nexport const runSync = (cmd, options) =>\n    childProcess.execSync(cmd, { windowsHide: true, ...options }).toString();\n"]}