{"version":3,"sources":["tryRequire.js"],"names":["tryRequireBy","packageName","mainModule","throwWhenNotFound","require2","text","ensureEndsWith","path","sep","require","error","code","pkgPaths","split","npmPkgName","startsWith","length","pos1","message","indexOf","realModuleName","substr","pos2","Error","undefined","tryRequire","basePath","main"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AAEA,SAASA,YAAT,CAAsBC,WAAtB,EAAmCC,UAAnC,EAA+CC,iBAA/C,EAAkE;AAC9D,MAAI;AACA,QAAI,OAAOD,UAAP,KAAsB,QAA1B,EAAoC;AAChC,YAAME,QAAQ,GAAG,2BAAcC,WAAKC,cAAL,CAAoBJ,UAApB,EAAgCK,cAAKC,GAArC,CAAd,CAAjB;AACA,aAAOJ,QAAQ,CAACH,WAAD,CAAf;AACH;;AAED,WAAOC,UAAU,CAACO,OAAX,CAAmBR,WAAnB,CAAP;AACH,GAPD,CAOE,OAAOS,KAAP,EAAc;AACZ,QAAIA,KAAK,CAACC,IAAN,KAAe,kBAAnB,EAAuC;AACnC,UAAIR,iBAAJ,EAAuB;AACnB,YAAIS,QAAQ,GAAGX,WAAW,CAACY,KAAZ,CAAkB,GAAlB,CAAf;AACA,YAAIC,UAAU,GAAGF,QAAQ,CAAC,CAAD,CAAzB;;AAEA,YAAIE,UAAU,CAACC,UAAX,CAAsB,GAAtB,CAAJ,EAAgC;AAC5B;AACA,gBAAML,KAAN;AACH;;AAED,YAAII,UAAU,CAACC,UAAX,CAAsB,GAAtB,KAA8BH,QAAQ,CAACI,MAAT,GAAkB,CAApD,EAAuD;AACnDF,UAAAA,UAAU,IAAI,MAAMF,QAAQ,CAAC,CAAD,CAA5B;AACH;;AAED,YAAIK,IAAI,GAAGP,KAAK,CAACQ,OAAN,CAAcC,OAAd,CAAsB,GAAtB,CAAX;AACA,YAAIC,cAAc,GAAGV,KAAK,CAACQ,OAAN,CAAcG,MAAd,CAAqBJ,IAAI,GAAC,CAA1B,CAArB;AACA,YAAIK,IAAI,GAAGF,cAAc,CAACD,OAAf,CAAuB,GAAvB,CAAX;AACAC,QAAAA,cAAc,GAAGA,cAAc,CAACC,MAAf,CAAsB,CAAtB,EAAyBC,IAAzB,CAAjB;;AAEA,YAAIF,cAAc,KAAKnB,WAAvB,EAAoC;AAChC,gBAAM,IAAIsB,KAAJ,CAAW,WAAUtB,WAAY,qCAAoCa,UAAW,8BAAhF,CAAN;AACH;;AAED,cAAMJ,KAAN;AACH;;AAED,aAAOc,SAAP;AACH;;AAED,UAAMd,KAAN;AACH;AACJ;AAED;AACA;AACA;AACA;;;AACA,SAASe,UAAT,CAAoBxB,WAApB,EAAiCyB,QAAjC,EAA2C;AACvC,SAAO1B,YAAY,CAACC,WAAD,EAAcQ,OAAO,CAACkB,IAAtB,EAA4BD,QAAQ,IAAI,IAAxC,CAAZ,IAA6D1B,YAAY,CAACC,WAAD,EAAcyB,QAAd,EAAwB,IAAxB,CAAhF;AACH;;AAAA;eAEcD,U","sourcesContent":["import { createRequire } from 'module';  \nimport { text } from '@genx/july';\nimport path from 'path';\n\nfunction tryRequireBy(packageName, mainModule, throwWhenNotFound) {        \n    try {            \n        if (typeof mainModule === 'string') {\n            const require2 = createRequire(text.ensureEndsWith(mainModule, path.sep));\n            return require2(packageName);\n        } \n\n        return mainModule.require(packageName);\n    } catch (error) {\n        if (error.code === 'MODULE_NOT_FOUND') {\n            if (throwWhenNotFound) {\n                let pkgPaths = packageName.split('/');\n                let npmPkgName = pkgPaths[0];\n\n                if (npmPkgName.startsWith('.')) {\n                    //path \n                    throw error;\n                }\n\n                if (npmPkgName.startsWith('@') && pkgPaths.length > 1) {\n                    npmPkgName += '/' + pkgPaths[1];\n                }\n\n                let pos1 = error.message.indexOf(\"'\");\n                let realModuleName = error.message.substr(pos1+1);\n                let pos2 = realModuleName.indexOf(\"'\");\n                realModuleName = realModuleName.substr(0, pos2);\n\n                if (realModuleName === packageName) {\n                    throw new Error(`Module \"${packageName}\" not found. Try run \"npm install ${npmPkgName}\" to install the dependency.`);\n                }\n\n                throw error;\n            }                \n\n            return undefined;\n        }\n\n        throw error;\n    }\n}\n\n/**\n * Try require a package module and show install tips if not found.\n * @param {string} packageName\n */\nfunction tryRequire(packageName, basePath) {    \n    return tryRequireBy(packageName, require.main, basePath == null) || tryRequireBy(packageName, basePath, true);\n};\n\nexport default tryRequire;"]}